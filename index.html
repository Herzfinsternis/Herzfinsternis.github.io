<!DOCTYPE html>
<html>
  <head>
    <title>applusext test 7</title>
  </head>
  <body>
    <input id="DOKUMENT" type="text" value="C:\Temp\test_doc.txt" />
    <script>
      const DOKUMENT = document.getElementById("DOKUMENT");
      DOKUMENT.onclick = dokumentOpen;
      
      async function dokumentOpen() {
        window.open("applusext:" + base64enc("open\r\n\"" + DOKUMENT.value + "\"\r\n"));
      }
      
      function base64enc(txt) {
        let ret = btoa(txt);
        // btoa uses "+", "/" and "="
        // replace with "-", "*" and "_" to avoid urlencoding
        ret = ret.replaceAll("+", "-").replaceAll("/", "*").replaceAll("=", "_");
        return ret;
      }
    </script>
  </body>
</html>
